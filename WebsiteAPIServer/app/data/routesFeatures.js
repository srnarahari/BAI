var _ = require('lodash');
var path = require('path');
var featureList = require(path.join(__dirname, 'featureList'));

var routesFeatureList = [
    //Class API
    { route: '/api/class/createclass', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removeclass', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updateclasssummary', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updateclasspicture', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/teacherDashboardNotification', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/upsertsyllabus', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updatesertclassplan', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/createnotice', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removenotice', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updatenotice', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/createforumcat', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removeforumcat', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/createclassfaq', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removeclassfaq', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updateclassfaq', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/assignclassresource', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/presentclassassign', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updateresourcetag', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updateresourceviews', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/updatepresentationviews', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/assigntest', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removeassignedtest', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/publishassignedtestresults', feature: featureList.availableFeatures().GetTestAnswer },
    // { route: '/api/class/publishassignedtestresults', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/getstudenttestparticipation', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/editstudenttestparticipation', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/getallclassstudents', feature: featureList.availableFeatures().GetAllClassStudents },
    { route: '/api/class/removeclassstudent', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/:classId/classstudents', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/activatestudent', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updatefeedback', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/registerclass', feature: featureList.availableFeatures().Registerclass },
    { route: '/api/class/unregisterclass', feature: featureList.availableFeatures().Registerclass },
    { route: '/api/class/:classId/getclasssummary', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/getclassfaq', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/getclassnotices', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/getclassresources', feature: featureList.availableFeatures().ReadResource },
    { route: '/api/class/:classId/getclasspresentations', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/:preId/getclasspresentation', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/getclassforumcats', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/allassignedtests', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/getresultslist', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/allclassnames', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/allclasswithforumtags', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/addteacherremark', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/getteacherremarks', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/removeteacherremarks', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/getstudentprogressreport', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/createbatch', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removebatch', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/editparticipantlist', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/:classId/getbatches', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/:classId/getpaidclassstudents', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/scheduleclasssessions', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/:classId/getschedulesessions', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/removescheduledsession', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/updatepausestatus', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/deleteclassplan', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/class/getallscheduledsessions', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/class/:classId/getplans', feature: featureList.availableFeatures().ReadClass },

    //Private Forum API
    { route: '/api/privateforum/createthread', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/getallthreads', feature: featureList.availableFeatures().ReadForum },
    { route: '/api/privateforum/removethread', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/edittopic', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/addcomment', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/addsubcommentcontent', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/editcomment', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/updatecommentvote', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/editsubcomment', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/loadsubcomments', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/updatereportedabuse', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/subscribeforumnotify', feature: featureList.availableFeatures().WriteForum },
    { route: '/api/privateforum/getthread', feature: featureList.availableFeatures().ReadForum },
    { route: '/api/privateforum/getsubscribethreads', feature: featureList.availableFeatures().ReadForum },

    //Resource API
    { route: '/api/resource/upserttextnote', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/uploadresource', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/updateresourcedetails', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/getresourcelist', feature: featureList.availableFeatures().ReadResource },
    { route: '/api/resource/upsertpresentation', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/getpresentationlist', feature: featureList.availableFeatures().ReadResource },
    { route: '/api/resource/:classId/:preId/getpresentation', feature: featureList.availableFeatures().ReadResource },
    { route: '/api/resource/removepresentation', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/removeresource', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/addasset', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/removeasset', feature: featureList.availableFeatures().WriteResource },
    { route: '/api/resource/getassetlist', feature: featureList.availableFeatures().WriteResource },

    //Payment API
    { route: '/api/payment/start', feature: featureList.availableFeatures().PaymentWrite },

    //Test API
    { route: '/api/test/createtest', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/updatetestdetails', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/savequestion', feature: featureList.availableFeatures().SaveTest },
    { route: '/api/test/deletequestion', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/updatequestionorder', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/createtestanswer', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/test/savetestsingleanswer', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/test/evaluate', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/savetestsingleevaluation', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/gettestresult', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/test/gettests', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/test/gettestdetails', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/test/gettest', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/test/checktestname', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/removetest', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/allowanothersubmission', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/studentclasstestlist', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/test/:classId/allassignedtests', feature: featureList.availableFeatures().ReadClass },
    { route: '/api/test/gettestpreview', feature: featureList.availableFeatures().WriteClass },
    { route: '/api/test/:classId/submittedtests', feature: featureList.availableFeatures().ReadClass },

    //Common Tests API
    { route: '/api/commontest/getalltests', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/commontest/register', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/commontest/:testId', feature: featureList.availableFeatures().ReadTest },
    { route: '/api/commontest/createtestanswer', feature: featureList.availableFeatures().WriteTest },
    { route: '/api/commontest/savetestsingleanswer', feature: featureList.availableFeatures().WriteTest }

];

exports.getRouteFeature = function(req) {
    return _.find(routesFeatureList, { route: req.route.path }).feature;
};